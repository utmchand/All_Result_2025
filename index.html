<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ</title>
  <style>
    body {
      font-family: 'Mangal', sans-serif;
      background: linear-gradient(to right, #e0f7fa, #fff);
      padding: 20px;
      margin: 0;
    }

    h2, h3 {
      color: #004d40;
      text-align: center;
      margin-bottom: 10px;
    }

    #inputSection {
      text-align: center;
      margin-bottom: 20px;
    }

    input[type="text"] {
      width: 250px;
      padding: 10px;
      font-size: 18px;
      border: 2px solid #26a69a;
      border-radius: 5px;
      margin-right: 10px;
      transition: all 0.3s ease;
    }

    input.error {
      border-color: red;
      animation: shake 0.3s;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }

    button {
      padding: 10px 20px;
      font-size: 18px;
      background-color: #00796b;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #004d40;
    }

    .print-btn {
      display: none;
      margin: 20px auto;
      background-color: #33691e;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    th, td {
      border: 1px solid #bbb;
      padding: 10px;
      font-size: 16px;
    }

    th {
      background-color: #80cbc4;
      color: #00332c;
    }

    tr:nth-child(even) {
      background-color: #f1f8e9;
    }

    #result {
      background-color: #ffffff;
      padding: 20px;
      margin-top: 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .division {
      padding: 10px;
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      border-radius: 5px;
      margin-top: 20px;
    }

    .first { background-color: #a5d6a7; color: #1b5e20; }
    .second { background-color: #ffe082; color: #e65100; }
    .third { background-color: #ffab91; color: #bf360c; }
    .fail { background-color: #ef9a9a; color: #b71c1c; }
    .supplementary { background-color: #d1c4e9; color: #4a148c; }

    @media (max-width: 600px) {
      table, th, td {
        font-size: 14px;
      }
      input[type="text"] {
        width: 100%;
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body>
  <h2>‡§∂‡§æ‡§∏‡§ï‡•Ä‡§Ø ‡§â.‡§Æ‡§æ.‡§µ‡§ø. ‡§ó‡•ã‡§∞‡§ñ‡§™‡•Å‡§∞, ‡§ú‡§ø‡§≤‡§æ - ‡§®‡§∞‡§∏‡§ø‡§Ç‡§π‡§™‡•Å‡§∞</h2>
  <h2>‡§õ:‡§Æ‡§æ‡§π‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ 2025 ‡§ï‡§æ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∞‡•ã‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</h2>
  <div id="inputSection">
    <input type="text" id="rollInput" placeholder="‡§∞‡•ã‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
    <button onclick="getResult()">‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
  </div>

  <div id="result"></div>
  <div style="text-align:center">
    <button class="print-btn" onclick="window.print()">üñ®Ô∏è ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü / PDF ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</button>
  </div>

  <script>
    function normalizeClass(raw) {
      if (!raw && raw !== 0) return "";
      raw = String(raw).trim().toLowerCase();
      if (/^9\b|9(‡§•‡•Ä|‡§µ‡•Ä‡§Ç|th)/.test(raw) || raw.includes("9")) return 9;
      if (/^10\b|10(‡§•‡•Ä|‡§µ‡•Ä‡§Ç|th)/.test(raw) || raw.includes("10")) return 10;
      if (/^11\b|11(‡§•‡•Ä|‡§µ‡•Ä‡§Ç|th)/.test(raw) || raw.includes("11")) return 11;
      if (/^12\b|12(‡§•‡•Ä|‡§µ‡•Ä‡§Ç|th)/.test(raw) || raw.includes("12")) return 12;
      // fallback to parseInt
      const n = parseInt(raw);
      if ([9,10,11,12].includes(n)) return n;
      return raw;
    }

    function getResult() {
      const rollInput = document.getElementById("rollInput");
      const roll = rollInput.value.trim();
      if (!roll) {
        rollInput.classList.add("error");
        setTimeout(() => rollInput.classList.remove("error"), 500);
        return;
      }

      const url = "https://script.google.com/macros/s/AKfycbyew0N89-t6qeic8gmdA-CZhLFGvzWXHojn68pdskhMweA53gkYEtS9WUisvf1ERxeoIA/exec?roll=" + encodeURIComponent(roll);

      fetch(url)
        .then(res => res.json())
        .then(data => {
          if (!data || data === "Roll number not found") {
            document.getElementById("result").innerHTML = "<p>‡§∞‡•ã‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§</p>";
            return;
          }

          // show basic student details
          let html = `
            <h2>‡§õ:‡§Æ‡§æ‡§π‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ 2025 ‡§ï‡•Ä ‡§Ö‡§Ç‡§ï‡§∏‡•Ç‡§ö‡•Ä</h2><h3>‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£</h3>
            <p><strong>‡§®‡§æ‡§Æ:</strong> ${data.Name || ""}</p>
            <p><strong>‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ:</strong> ${data.Father || ""}</p>
            <p><strong>‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§•‡§ø:</strong> ${data.DOB || ""}</p>
            <p><strong>‡§ï‡§ï‡•ç‡§∑‡§æ:</strong> ${data.Class || ""}</p>
          `;

          // collect subjects from returned JSON (keys like "Hindi T", "Hindi P")
          const subjectMap = {};
          for (let key in data) {
            if (key.endsWith(" T") || key.endsWith(" P")) {
              const subject = key.slice(0, -2).trim();
              if (!subjectMap[subject]) subjectMap[subject] = { theory: 0, practical: 0 };
              if (key.endsWith(" T")) subjectMap[subject].theory = Number(data[key]) || 0;
              if (key.endsWith(" P")) subjectMap[subject].practical = Number(data[key]) || 0;
            }
          }

          html += `<table><tr><th>‡§µ‡§ø‡§∑‡§Ø</th><th>‡§•‡•ç‡§Ø‡•ã‡§∞‡•Ä ‡§Ö‡§Ç‡§ï</th><th>‡§™‡•ç‡§∞‡•à‡§ï‡•ç‡§ü‡§ø‡§ï‡§≤ ‡§Ö‡§Ç‡§ï</th><th>‡§ï‡•Å‡§≤ ‡§Ö‡§Ç‡§ï</th></tr>`;

          // Passing rules explicit per class & subject (as you specified)
          const passingRules = {
            "9-10": {
              "Hindi": { theory: 25, practical: 8, tMax:75, pMax:25 },
              "English": { theory: 25, practical: 8, tMax:75, pMax:25 },
              "Sanskrit": { theory: 25, practical: 8, tMax:75, pMax:25 },
              "Maths": { theory: 25, practical: 8, tMax:75, pMax:25 },
              "Science": { theory: 25, practical: 8, tMax:75, pMax:25 },
              "Social_Science": { theory: 25, practical: 8, tMax:75, pMax:25 },
              "IT": { theory: 14, practical: 20, tMax:40, pMax:60 },
              "AG": { theory: 14, practical: 20, tMax:40, pMax:60 }
              
            },
            "11-12": {
              "Hindi": { theory: 27, practical: 7, tMax:80, pMax:20 },
              "English": { theory: 27, practical: 7, tMax:80, pMax:20 },
              "History": { theory: 27, practical: 7, tMax:80, pMax:20 },
              "PolSc": { theory: 27, practical: 7, tMax:80, pMax:20 },
              "Maths": { theory: 27, practical: 7, tMax:80, pMax:20 },
              "Geo": { theory: 23, practical: 10, tMax:70, pMax:30 },
              "Biology": { theory: 23, practical: 10, tMax:70, pMax:30 },
              "Physics": { theory: 23, practical: 10, tMax:70, pMax:30 },
              "Chemistry": { theory: 23, practical: 10, tMax:70, pMax:30 },
              "IT": { theory: 17, practical: 17, tMax:50, pMax:50 },
              "AG": { theory: 17, practical: 17, tMax:50, pMax:50 }
            }
          };

          // default maxima if subject not in map
          const defaultMax = { tMax: 80, pMax: 20 };

          let grandTotal = 0;
          let failCount = 0;
          let totalSubjects = 0;
          const rawClass = data.Class;
          const classNum = normalizeClass(rawClass);

          // to collect supplementary subject names
          const supplementarySubjects = [];

          // iterate subjects
          for (let subject in subjectMap) {
            const theory = Number(subjectMap[subject].theory) || 0;
            const practical = Number(subjectMap[subject].practical) || 0;
            const total = theory + practical;

            // skip empty subjects
            if (theory === 0 && practical === 0) continue;

            html += `<tr><td>${subject}</td><td>${theory}</td><td>${practical}</td><td>${total}</td></tr>`;
            grandTotal += total;
            totalSubjects++;

            // determine pass thresholds for this subject given the class
            let threshold = null;
            if (classNum === 9 || classNum === 10) {
              threshold = passingRules["9-10"][subject] || null;
            } else if (classNum === 11 || classNum === 12) {
              threshold = passingRules["11-12"][subject] || null;
            } else {
              // unknown class ‚Äî apply default 33% on generic maxima
              threshold = null;
            }

            let isFail = false;

            if (threshold) {
              // use explicit thresholds (both theory and practical must meet)
              const reqTheory = Number(threshold.theory);
              const reqPractical = Number(threshold.practical);
              if (theory < reqTheory || practical < reqPractical) {
                isFail = true;
              }
            } else {
              // fallback: use 33% of maxima
              const tMax = (classNum >= 11 && passingRules["11-12"][subject] && passingRules["11-12"][subject].tMax) ||
                           (classNum <= 10 && passingRules["9-10"][subject] && passingRules["9-10"][subject].tMax) ||
                           defaultMax.tMax;
              const pMax = (classNum >= 11 && passingRules["11-12"][subject] && passingRules["11-12"][subject].pMax) ||
                           (classNum <= 10 && passingRules["9-10"][subject] && passingRules["9-10"][subject].pMax) ||
                           defaultMax.pMax;

              const reqTheory = Math.ceil(tMax * 0.33);
              const reqPractical = Math.ceil(pMax * 0.33);
              if (theory < reqTheory || practical < reqPractical) {
                isFail = true;
              }
            }

            if (isFail) {
              failCount++;
              // record the subject name for supplementary listing (only if it is considered fail)
              supplementarySubjects.push(subject);
            }
          } // end for subjects

          html += `</table>`;

          // compute percentage: use totalSubjects * 100 as denominator (each subject total assumed 100)
          // (You already used this approach earlier; kept same for compatibility)
          let percentage = 0;
          if (totalSubjects > 0) {
            percentage = (grandTotal / (totalSubjects * 100)) * 100;
            percentage = Number(percentage.toFixed(2));
          }

          // Decide division/result according to rules given
          let division = "‡§Ö‡§®‡•Å‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£", divisionClass = "fail";
          if (classNum === 9 || classNum === 10) {
            // 9-10 rules: 0 or 1 fail -> PASS, 2 -> SUPPLEMENTARY, >=3 -> FAIL
            if (failCount >= 3) {
              division = "‡§Ö‡§®‡•Å‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£"; divisionClass = "fail";
            } else if (failCount === 2) {
              division = "‡§∏‡§™‡•ç‡§≤‡•Ä‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∞‡•Ä"; divisionClass = "supplementary";
            } else {
              // 0 or 1 fails -> PASS (but still determine division by percentage if 0 fails)
              if (failCount === 0) {
                if (percentage >= 60) { division = "‡§™‡•ç‡§∞‡§•‡§Æ"; divisionClass = "first"; }
                else if (percentage >= 45) { division = "‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø"; divisionClass = "second"; }
                else if (percentage >= 33) { division = "‡§§‡•É‡§§‡•Ä‡§Ø"; divisionClass = "third"; }
                else { division = "‡§Ö‡§®‡•Å‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£"; divisionClass = "fail"; } // edge case: total%<33
              } else {
                // 1 fail => PASS by your rule (show as PASS)
                division = "‡§â‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£"; divisionClass = "first";
              }
            }
          } else if (classNum === 11 || classNum === 12) {
            // 11-12 rules: 0 -> PASS, 1 -> SUPPLEMENTARY, >=2 -> FAIL
            if (failCount >= 2) {
              division = "‡§Ö‡§®‡•Å‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£"; divisionClass = "fail";
            } else if (failCount === 1) {
              division = "‡§∏‡§™‡•ç‡§≤‡•Ä‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∞‡•Ä"; divisionClass = "supplementary";
            } else {
              // failCount === 0
              if (percentage >= 60) { division = "‡§™‡•ç‡§∞‡§•‡§Æ"; divisionClass = "first"; }
              else if (percentage >= 45) { division = "‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø"; divisionClass = "second"; }
              else if (percentage >= 33) { division = "‡§§‡•É‡§§‡•Ä‡§Ø"; divisionClass = "third"; }
              else { division = "‡§Ö‡§®‡•Å‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£"; divisionClass = "fail"; } // edge case
            }
          } else {
            // unknown class fallback
            division = (failCount === 0) ? "‡§â‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£" : (failCount === 1 ? "‡§∏‡§™‡•ç‡§≤‡•Ä‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∞‡•Ä" : "‡§Ö‡§®‡•Å‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£");
            divisionClass = (division === "‡§â‡§§‡•ç‡§§‡•Ä‡§∞‡•ç‡§£") ? "first" : (division === "‡§∏‡§™‡•ç‡§≤‡•Ä‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∞‡•Ä" ? "supplementary" : "fail");
          }

          // Build final display with supplementary subjects if any
          html += `
            <h3>‡§ï‡•Å‡§≤ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§‡§æ‡§Ç‡§ï: ${grandTotal}</h3>
            <h3>‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§: ${percentage} %</h3>
          `;

          if (division === "‡§∏‡§™‡•ç‡§≤‡•Ä‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∞‡•Ä") {
            // show which subjects (but within the rule behavior)
            html += `<div class="division ${divisionClass}">‡§∂‡•ç‡§∞‡•á‡§£‡•Ä: ${division}</div>`;
            if (supplementarySubjects.length > 0) {
              html += `<p style="text-align:center; font-weight:bold; margin-top:10px;">‡§∏‡§™‡•ç‡§≤‡•Ä‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∞‡•Ä ‡§µ‡§ø‡§∑‡§Ø: ${supplementarySubjects.join(", ")}</p>`;
            }
          } else {
            html += `<div class="division ${divisionClass}">‡§∂‡•ç‡§∞‡•á‡§£‡•Ä: ${division}</div>`;
          }

          document.getElementById("result").innerHTML = html;
          document.querySelector(".print-btn").style.display = "inline-block";
        })
        .catch(err => {
          console.error(err);
          document.getElementById("result").innerHTML = "<p>‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•ã‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§ï‡•Ä ‡§ú‡•â‡§ö ‡§ï‡§∞‡•á‡§Ç‡•§</p>";
        });
    }
  </script>

<script>
  // Right-click disable
  document.addEventListener('contextmenu', e => e.preventDefault());

  // Text selection disable
  document.addEventListener('selectstart', e => e.preventDefault());

  // Keyboard shortcut block (Ctrl+U, Ctrl+C, Ctrl+S, Ctrl+A)
  document.addEventListener('keydown', function (e) {
    if (e.ctrlKey && ['u', 'c', 's', 'a'].includes(e.key.toLowerCase())) {
      e.preventDefault();
    }
  });

  // F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C disable
  document.onkeydown = function (e) {
    if (e.keyCode === 123 ||
        (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key.toUpperCase()))) {
      return false;
    }
  };
</script>

<footer style="text-align: center; margin-top: 30px; padding: 15px; background-color: #f0f0f0; font-size: 15px; color: #444;">
    <div style="font-size: 18px; color: #388e3c; font-weight: bold;">‚ú¶ {U.C.D.} ‚ú¶</div>
    ¬© 2025 ‡§∂‡§æ‡§∏‡§ï‡•Ä‡§Ø ‡§â.‡§Æ‡§æ.‡§µ‡§ø. ‡§ó‡•ã‡§∞‡§ñ‡§™‡•Å‡§∞, ‡§ú‡§ø‡§≤‡§æ - ‡§®‡§∞‡§∏‡§ø‡§Ç‡§π‡§™‡•Å‡§∞ (‡§Æ.‡§™‡•ç‡§∞.) | Developed & Maintained by Uttam Chand Dehriya (Vocational Trainer - I.T.)
</footer>

</body>
</html>